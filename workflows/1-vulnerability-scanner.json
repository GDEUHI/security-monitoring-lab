{
    "name": "Vulnerability Scanner Workflow",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [{"field": "hours", "expression": "*/12"}]
                }
            },
            "name": "Schedule",
            "type": "n8n-nodes-base.scheduleTrigger"
        },
        {
            "parameters": {
                "command": "nmap -sV -sC -oX /tmp/scan_results.xml localhost",
                "executeTimeout": 300
            },
            "name": "Run Nmap Scan",
            "type": "n8n-nodes-base.executeCommand"
        },
        {
            "parameters": {
                "filePath": "/tmp/scan_results.xml"
            },
            "name": "Read Results",
            "type": "n8n-nodes-base.readFile"
        },
        {
            "parameters": {
                "url": "http://elasticsearch:9200/scans/_doc",
                "sendBody": true,
                "bodyParameters": {
                    "scan_data": "={{$json.data}}",
                    "timestamp": "={{$now}}"
                }
            },
            "name": "Store Results",
            "type": "n8n-nodes-base.httpRequest"
        }
    ]
}
