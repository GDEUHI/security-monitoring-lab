{
    "name": "Level 3 - Automated Penetration Testing",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [{"field": "weeks", "expression": "1"}]
                }
            },
            "name": "Weekly Test",
            "type": "n8n-nodes-base.scheduleTrigger"
        },
        {
            "parameters": {
                "command": "docker exec kali msfconsole -q -x 'workspace -a weekly_audit; db_nmap -sV TARGET_IP; vulns; exit'",
                "executeTimeout": 1800
            },
            "name": "Run MSF Scan",
            "type": "n8n-nodes-base.executeCommand"
        },
        {
            "parameters": {
                "command": "docker exec kali nikto -h TARGET_IP -Format xml -output /shared/nikto_results.xml",
                "executeTimeout": 1800
            },
            "name": "Web Vulnerability Scan",
            "type": "n8n-nodes-base.executeCommand"
        },
        {
            "parameters": {
                "filePath": "/shared/nikto_results.xml",
                "options": {
                    "parseXml": true
                }
            },
            "name": "Process Results",
            "type": "n8n-nodes-base.readFile"
        },
        {
            "parameters": {
                "functionCode": "const results = $input.all()[0].json;\nconst report = generatePentestReport(results);\nreturn {json: {report}};"
            },
            "name": "Generate Report",
            "type": "n8n-nodes-base.function"
        }
    ]
}
